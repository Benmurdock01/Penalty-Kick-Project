---
title: "Project_251"
format: pdf
author: "Brandon Upper, Ben Murdock, Hannah Lyons"
editor_options: 
  chunk_output_type: console
---

```{r}
#library
library(vroom)
library(ggplot2)
library(tidyverse)
library(dplyr)
```

```{r}
#data
shootouts <- vroom('./WorldCupShootouts.csv')
```

#Short Written Description Our dataset contains information on World Cup penalty shootouts from Spain 1982 to Russia 2018 sourced from Kaggle. URL: [World Cup Penalty Shootouts Dataset](https://www.kaggle.com/datasets/pablollanderos33/world-cup-penalty-shootouts)

The dataset contains 305 rows in total. The first row is a descriptive header, leaving 304 rows of actual data and 9 columns. The columns include: Game_id: Each team in a single game get's a number. Numbers are not repeated across separate games. Team: The country team of the kicker. Zone: The goal was divided into 9 sections, each labeled by number. This number is the zone. Foot: The foot used to take the shot (Left/Right). Keeper: The direction the goalkeeper dove(Left/Right) On Target: Indicates whether the shot would have been a goal if the keeper had not intervened(1 = Yes, 0 = No) Goal: Whether the penalty was successfully scored (1 = Goal, 0 = Miss) Penalty number: The order of the penalty within the shootout Elimination: Indicates whether the penalty could end the game (1 = Yes, 0 = No)

# Ben: Proposed Research Question, left/right success bar graph.

We would like to determine if there is a difference between proportion of successful penalty kicks of right footed vs. left footed soccer players.

# Brandon: EDA

The proposed data source and a well-organized and well-articulated exploratory analysis of its contents (this should include well-labeled plots created in R).

Libraries

```{r}
library(ggplot2)
library(vroom)
library(tidyverse)
```

Read File

```{r}
Soccer_data <- vroom("WorldCupShootouts.csv")
summary(Soccer_data)
head(Soccer_data)
```
Reading in our file we can see various factors, features and variables that 
are described more in depth in the above short description of the data. From 
this code we can see the first five rows of the data and notice that many points
are read in as doubles and characters. For the final analysis, we likely will 
convert some of these variables for simplicity

Basic plots about Goals and Penalties

```{r}
Soccer_data <- Soccer_data %>%
  filter(is.finite(Zone)) 
ggplot(data = Soccer_data) + 
  geom_bar(mapping = aes(x = Zone), 
           fill = "lightblue") + ggtitle("Goals by Zone") + ylab("Count")
ggplot(data = Soccer_data) + 
  geom_bar(mapping = aes(y = Penalty_Number), fill = "navyblue") + 
  ggtitle("Penalty Number by Count") + ylab("Penalty Number") + xlab("Count")
```
These graphs give some visuals to some of the data and the types penalties we're
seeing. For example, its clear that different zones have higher portions of 
goals scored, and when we recognize that the zone targeted and thereby goal 
likelihood can be highly influenced by right vs left footed kickers. From 
prior soccer experience, we could look for tendencies in the final project for 
kickers to shoot towards met opposite of their dominant foot. The second graph
also displays how long the shootout lasts for, and its clear that most of them
end before or around the twelfth number. 


Looking for Correlation

```{r}
numeric_data <- Soccer_data %>%
  select(where(is.numeric))

library(corrplot)
cor_matrix <- cor(numeric_data)
corrplot(cor_matrix)
```
There seems to be no strong correlations between any of the numeric variables.
This is useful as we can see that this data is unlikely to have issues with 
multicollinearity. 

```{r}
#left vs right foot - success proportion

plot_data <- Soccer_data %>%
  select(Foot, Goal) %>% 
  filter(Foot %in% c("L", "R"),
         Goal %in% c(0, 1)) %>%
  mutate(Goal_Status = factor(Goal, 
                              levels = c(0, 1), 
                              labels = c("Miss", "Success")))

ggplot(plot_data, aes(x = Foot, fill = Goal_Status)) +
  geom_bar(position = "dodge")
```
